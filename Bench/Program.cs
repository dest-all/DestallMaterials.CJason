using System.Text;
using System.Text.Json;
using System.Text.Json.Serialization;
using BenchmarkDotNet.Attributes;
using BenchmarkDotNet.Order;
using BenchmarkDotNet.Running;
using SampleNamespace;

BenchmarkRunner.Run<BenchRunner>();

[MemoryDiagnoser]
[Orderer(SummaryOrderPolicy.FastestToSlowest)]
[RankColumn]
public class BenchRunner
{
    static readonly Father[] _data = new Father[]
    {
        new Father
        {
            Name = "Alex",
            Age = 51,
            Children = new Child[]
            {
                new() { Name = "Igor", Age = 26 },
                new() { Name = "Someone", Age = 555 }
            }
        }
    };

    [Benchmark]
    public void Standard()
    {
        var json = JsonSerializer.Serialize(_data);
    }

    [Benchmark]
    public void Autogenerated()
    {
        var json = _data.AsSpan().Serialize();
    }
}
